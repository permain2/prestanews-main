---
import type { CollectionEntry } from 'astro:content';
import FormattedDate from '../components/FormattedDate.astro';
import MainLayout from './MainLayout.astro';

type Props = CollectionEntry<'blog'>['data'];

const { title, description, pubDate, updatedDate, heroImage, tags } = Astro.props;
---

<MainLayout title={title} description={description}>
    <article class="article-page">
        <!-- Header Section -->
        <header class="article-header">
            <div class="header-container">
                {tags && tags[0] && (
                    <a href={`/news/${tags[0]}`} class="category-link">
                        {tags[0].replace('-', ' ')}
                    </a>
                )}
                <h1 class="article-title">{title}</h1>
                <div class="article-meta">
                    <span class="author">By PrestaNews Team</span>
                    <span class="separator">|</span>
                    <span class="date"><FormattedDate date={pubDate} /></span>
                    {updatedDate && (
                        <>
                            <span class="separator">|</span>
                            <span class="updated">Updated: <FormattedDate date={updatedDate} /></span>
                        </>
                    )}
                </div>
            </div>
        </header>

        <!-- Hero Image -->
        {heroImage && (
            <div class="hero-image-container">
                <img src={heroImage} alt={title} class="hero-image" />
            </div>
        )}

        <!-- Content Section -->
        <div class="content-wrapper">
            <div class="content-grid">
                <!-- Main Content -->
                <main class="main-content">
                    <div class="article-body">
                        <slot />
                    </div>
                    
                    <!-- Tags -->
                    {tags && tags.length > 0 && (
                        <div class="article-tags">
                            <span class="tags-label">Related Topics:</span>
                            <div class="tags-list">
                                {tags.map((tag: string) => (
                                    <a href={`/tags/${tag}`} class="tag">
                                        {tag.replace('-', ' ')}
                                    </a>
                                ))}
                            </div>
                        </div>
                    )}
                </main>

                <!-- Sidebar -->
                <aside class="sidebar">
                    <div class="sidebar-sticky">
                        <!-- Newsletter -->
                        <div class="newsletter-box">
                            <div class="newsletter-icon">
                                <img src="/icons/newsletter.png" alt="Newsletter" />
                            </div>
                            <p class="newsletter-text">Get the latest deals and news delivered to your inbox weekly.</p>
                            <a href="/newsletter" class="btn-apply" style="border-radius: 0.25rem;">Subscribe Now</a>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </article>
</MainLayout>

<style>
    .article-page {
        background: #ffffff;
    }

    /* Header */
    .article-header {
        padding: 3rem 0 2rem;
        border-bottom: 1px solid #E6E8EB;
    }

    .header-container {
        max-width: 52rem;
        margin: 0 auto;
        padding: 0 2rem;
    }

    .category-link {
        display: inline-block;
        font-family: 'Sora', sans-serif;
        font-size: 0.875rem;
        font-weight: 700;
        text-transform: uppercase;
        color: #006056;
        text-decoration: none;
        margin-bottom: 1rem;
        letter-spacing: 0.5px;
    }

    .category-link:hover {
        color: #0D2C4B;
    }

    .article-title {
        font-family: 'Sora', sans-serif;
        font-size: clamp(2rem, 4vw, 3rem);
        font-weight: 700;
        line-height: 1.2;
        color: #162433;
        margin-bottom: 1.5rem;
    }

    .article-meta {
        font-family: 'Poppins', sans-serif;
        font-size: 0.875rem;
        color: #68727C;
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        align-items: center;
    }

    .separator {
        color: #D5D9DD;
    }

    .author {
        font-weight: 600;
        color: #162433;
    }

    /* Hero Image */
    .hero-image-container {
        max-width: 52rem;
        margin: 0 auto;
        padding: 2rem;
    }

    .hero-image {
        width: 100%;
        height: auto;
        border-radius: 0.5rem;
    }

    /* Content Wrapper */
    .content-wrapper {
        max-width: 82rem;
        margin: 0 auto;
        padding: 3rem 2rem;
    }

    .content-grid {
        display: grid;
        grid-template-columns: 1fr 280px;
        gap: 4rem;
    }

    /* Main Content */
    .main-content {
        max-width: 52rem;
    }

    .article-body {
        font-family: 'Poppins', sans-serif;
        font-size: 1.125rem;
        line-height: 1.9;
        color: #162433;
    }

    .article-body :global(h2) {
        font-family: 'Sora', sans-serif;
        font-size: 1.75rem;
        font-weight: 700;
        color: #162433;
        margin-top: 3rem;
        margin-bottom: 1.5rem;
        line-height: 1.3;
    }

    .article-body :global(h3) {
        font-family: 'Sora', sans-serif;
        font-size: 1.375rem;
        font-weight: 700;
        color: #162433;
        margin-top: 2.5rem;
        margin-bottom: 1rem;
        line-height: 1.4;
    }

    .article-body :global(p) {
        margin-bottom: 1.5rem;
    }

    .article-body :global(ul),
    .article-body :global(ol) {
        margin-bottom: 1.5rem;
        padding-left: 1.5rem;
    }

    .article-body :global(li) {
        margin-bottom: 0.75rem;
    }

    .article-body :global(strong) {
        font-weight: 700;
        color: #162433;
    }

    .article-body :global(a) {
        color: #146aff;
        text-decoration: none;
        border-bottom: 2px solid #146aff;
    }

    .article-body :global(a:hover) {
        background: #0040B1;
        color: #ffffff;
        border-bottom-color: #0040B1;
    }

    .article-body :global(blockquote) {
        margin: 2rem 0;
        padding: 1.5rem 2rem;
        background: #F7F8FA;
        border-left: 4px solid #146aff;
        font-style: italic;
    }

    /* Tags */
    .article-tags {
        margin-top: 3rem;
        padding-top: 2rem;
        border-top: 1px solid #E6E8EB;
    }

    .tags-label {
        font-family: 'Sora', sans-serif;
        font-size: 0.875rem;
        font-weight: 700;
        color: #162433;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        display: block;
        margin-bottom: 1rem;
    }

    .tags-list {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
    }

    .tag {
        font-family: 'Poppins', sans-serif;
        font-size: 0.875rem;
        font-weight: 500;
        color: #162433;
        background: #F7F8FA;
        padding: 0.5rem 1rem;
        border-radius: 2rem;
        text-decoration: none;
        transition: all 0.2s;
    }

    .tag:hover {
        background: #0D2C4B;
        color: #ffffff;
    }

    /* Sidebar */
    .sidebar {
        /* Minimal sidebar */
    }

    .sidebar-sticky {
        position: sticky;
        top: 6rem;
    }

    .newsletter-box {
        background: #0D2C4B;
        padding: 2rem;
        border-radius: 0.5rem;
        text-align: center;
    }

    .newsletter-icon {
        width: 48px;
        height: 48px;
        margin: 0 auto 1rem;
        filter: brightness(0) invert(1);
    }

    .newsletter-icon img {
        width: 100%;
        height: 100%;
    }

    .newsletter-text {
        font-family: 'Poppins', sans-serif;
        font-size: 0.9375rem;
        color: rgba(255, 255, 255, 0.85);
        line-height: 1.6;
        margin-bottom: 1.5rem;
    }

    .newsletter-btn {
        display: block;
        background: #146aff;
        color: #ffffff;
        font-family: 'Poppins', sans-serif;
        font-size: 0.875rem;
        font-weight: 600;
        padding: 0.875rem 1.5rem;
        border-radius: 0.25rem;
        text-decoration: none;
        transition: background 0.2s;
    }

    .newsletter-btn:hover {
        background: #0040B1;
    }

    /* Responsive */
    @media (max-width: 1024px) {
        .content-grid {
            grid-template-columns: 1fr;
            gap: 3rem;
        }

        .sidebar {
            order: -1;
        }

        .sidebar-sticky {
            position: static;
        }
    }

    @media (max-width: 768px) {
        .article-header {
            padding: 2rem 0 1.5rem;
        }

        .header-container,
        .hero-image-container,
        .content-wrapper {
            padding-left: 1.25rem;
            padding-right: 1.25rem;
        }

        .article-body {
            font-size: 1rem;
            line-height: 1.8;
        }

        .article-body :global(h2) {
            font-size: 1.5rem;
            margin-top: 2.5rem;
        }

        .article-body :global(h3) {
            font-size: 1.25rem;
            margin-top: 2rem;
        }
    }
</style>
